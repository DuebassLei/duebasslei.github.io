# DuebassLei 博客项目规则文件

## 项目概述
这是一个基于 VitePress 的个人技术博客项目，使用 @sugarat/theme 主题，主要展示技术文档和 SOP（标准操作程序）。

## 技术栈

### 核心框架
- **VitePress**: 2.0.0-alpha.12 - 静态站点生成器
- **Vue**: 3.5.12 - 前端框架
- **TypeScript**: 5.4.5 - 类型系统

### 主题和UI
- **@sugarat/theme**: 0.5.7 - 博客主题
- **Element Plus**: 2.7.2 - UI 组件库
- **@element-plus/icons-vue**: 2.3.1 - 图标库

### 其他依赖
- **oh-my-live2d**: 0.19.3 - Live2D 看板娘
- **pagefind**: 1.3.0 - 离线全文搜索
- **sass**: 1.76.0 - CSS 预处理器

### 包管理器
- **pnpm** - 必须使用 pnpm 进行依赖管理

## 项目结构

```
.
├── docs/                    # 文档根目录
│   ├── .vitepress/         # VitePress 配置目录
│   │   ├── config.mts      # VitePress 主配置文件
│   │   ├── blog-theme.ts   # 主题配置文件
│   │   ├── theme/          # 主题自定义文件
│   │   └── plugins/        # VitePress 插件
│   ├── public/             # 静态资源
│   │   ├── favicon.ico
│   │   ├── logo.png
│   │   └── robots.txt
│   ├── sop/                # 标准操作程序文档
│   │   ├── ai/             # AI 相关文档
│   │   ├── backend/        # 后端开发文档
│   │   ├── datasource/     # 数据库文档
│   │   ├── devops/         # 运维文档
│   │   ├── frontend/       # 前端开发文档
│   │   └── middleware/     # 中间件文档
│   ├── about.md            # 关于我页面
│   ├── index.md            # 首页
│   └── works.md            # 作品页面
├── .github/                # GitHub 配置
│   └── workflows/          # GitHub Actions 工作流
│       └── deploy.yml      # 部署配置
├── package.json            # 项目配置
├── yarn.lock               # 锁定文件（应使用 pnpm-lock.yaml）
└── README.md               # 项目说明
```

## 代码规范

### TypeScript 配置
- 使用 TypeScript 进行类型检查
- 配置文件使用 `.mts` 扩展名（如 `config.mts`）
- 遵循 Vue 3 Composition API 风格

### 文件命名规范
- Markdown 文件：使用小写字母和连字符，如 `about.md`, `index.md`
- TypeScript 配置文件：使用 `.mts` 扩展名
- Vue 组件：使用 PascalCase，如 `MyComponent.vue`
- 样式文件：使用 `.scss` 或 `.css`

### 代码风格
- 使用 2 个空格缩进
- 字符串使用单引号
- 语句末尾不使用分号（遵循项目现有风格）
- 导入语句使用 ES6 模块语法

### Markdown 文档规范
- 文档必须包含 frontmatter 元数据：
  ```yaml
  ---
  title: 文档标题
  description: 文档描述
  tag: [标签1, 标签2]
  sidebar: false  # 可选
  date: YYYY-MM-DD
  ---
  ```
- 使用标准 Markdown 语法
- 支持任务列表：`* [ ] TODO` 或 `* [x] 已完成`

## 开发流程

### 本地开发
```bash
# 安装依赖（必须使用 pnpm）
pnpm install

# 启动开发服务器
pnpm dev

# 构建生产版本
pnpm build

# 预览构建产物
pnpm serve
```

### 依赖管理
- **必须使用 pnpm** 作为包管理器
- 添加依赖：`pnpm add <package-name>`
- 添加开发依赖：`pnpm add -D <package-name>`
- 更新依赖：`pnpm update`

### 配置修改

#### VitePress 配置
- 主配置文件：`docs/.vitepress/config.mts`
- 主题配置：`docs/.vitepress/blog-theme.ts`
- 修改导航：编辑 `config.mts` 中的 `nav` 数组
- 修改 base 路径：仅在需要部署到子路径时修改 `base` 字段

#### 主题配置
- 主题色：在 `blog-theme.ts` 中修改 `themeColor`
- 页脚信息：修改 `footer` 配置
- 友链：修改 `friend` 数组
- Live2D 看板娘：修改 `oml2d` 配置

### 添加新文档
1. 在 `docs/sop/` 相应目录下创建 Markdown 文件
2. 添加 frontmatter 元数据
3. 如需在导航中显示，在 `config.mts` 的 `nav` 数组中添加链接

### 部署
- 使用 GitHub Actions 自动部署到 GitHub Pages
- 工作流文件：`.github/workflows/deploy.yml`
- 触发条件：推送到 `master` 分支
- 构建产物输出到：`docs/.vitepress/dist`

## 特殊功能

### Live2D 看板娘
- 使用 `oh-my-live2d` 库实现
- 配置在 `blog-theme.ts` 的 `oml2d` 选项中
- 支持移动端显示（`mobileDisplay: true`）

### 全文搜索
- 使用 `pagefind` 提供离线全文搜索
- 默认开启，可通过配置关闭：`search: false`

### RSS 支持
- 可选功能，需在 `blog-theme.ts` 中配置 RSS 选项
- 当前未开启，可按需启用

### 图表支持
- 支持 Mermaid 图表（默认关闭）
- 开启会增加构建耗时：`mermaid: true`

## 注意事项

1. **包管理器**：必须使用 `pnpm`，不要使用 `npm` 或 `yarn`
2. **Node 版本**：建议使用 Node.js 20.x（CI/CD 中配置）
3. **文档路径**：所有文档内容必须放在 `docs/` 目录下
4. **静态资源**：放在 `docs/public/` 目录下，访问路径为 `/filename`
5. **Git 提交**：提交前确保构建通过 `pnpm build`
6. **忽略文件**：已配置 `.gitignore`，不要提交 `node_modules`、`dist` 等文件

## Git 工作流

- 主分支：`master`
- 推送 `master` 分支会自动触发部署
- 确保 `.github/workflows/deploy.yml` 配置正确

## 性能优化建议

1. 图片资源建议使用 CDN 或压缩后放入 `public/` 目录
2. 大型文档建议拆分多个文件
3. 如非必要，保持 Mermaid 图表功能关闭
4. 定期更新依赖包版本

## 扩展功能

### 添加自定义 Vue 组件
- 在 `docs/.vitepress/theme/` 目录下创建组件
- 在 `theme/index.ts` 中注册组件

### 添加 VitePress 插件
- 在 `docs/.vitepress/plugins/` 目录下创建插件文件
- 在 `config.mts` 中引入并配置插件

### 自定义样式
- 主题样式：`docs/.vitepress/theme/style.scss`
- 用户自定义样式：`docs/.vitepress/theme/user-theme.css`

## 问题排查

### 常见问题
1. **依赖安装失败**：确保使用 `pnpm install`，检查 Node 版本
2. **构建失败**：检查 TypeScript 类型错误，查看构建日志
3. **页面空白**：检查 `base` 路径配置是否正确
4. **搜索不工作**：确保 `pagefind` 已正确安装

## 参考文档

- [VitePress 官方文档](https://vitepress.dev/)
- [@sugarat/theme 主题文档](https://theme.sugarat.top/)
- [Vue 3 文档](https://vuejs.org/)
- [Element Plus 文档](https://element-plus.org/)
- [oh-my-live2d 文档](https://oml2d.hacxy.cn/)

