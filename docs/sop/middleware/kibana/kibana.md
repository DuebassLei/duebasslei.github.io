---
title: Kibanaå®ç”¨æ“ä½œç¬”è®°
description: KibanaåŸºç¡€æ ¸å¿ƒçŸ¥è¯†åŠå¸¸ç”¨æ“ä½œæ•´ç†
tag:
  - Kibana
  - æ•°æ®å¯è§†åŒ–
  - ELK
sidebar: true
outline: [2,3,4]
lastUpdated: true
---

## ğŸ“– ç›®å½•

- [Kibana åŸºç¡€æ¦‚å¿µ](#kibana-åŸºç¡€æ¦‚å¿µ)
- [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
- [Discoverï¼ˆå‘ç°ï¼‰](#discoverå‘ç°)
- [Visualizeï¼ˆå¯è§†åŒ–ï¼‰](#visualizeå¯è§†åŒ–)
- [Dashboardï¼ˆä»ªè¡¨æ¿ï¼‰](#dashboardä»ªè¡¨æ¿)
- [Dev Toolsï¼ˆå¼€å‘å·¥å…·ï¼‰](#dev-toolså¼€å‘å·¥å…·)
- [KQL æŸ¥è¯¢è¯­è¨€](#kql-æŸ¥è¯¢è¯­è¨€)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

---

## Kibana åŸºç¡€æ¦‚å¿µ

### ä»€ä¹ˆæ˜¯ Kibanaï¼Ÿ

Kibana æ˜¯ä¸€ä¸ªå¼€æºçš„æ•°æ®å¯è§†åŒ–å¹³å°ï¼Œç”¨äº Elasticsearch æ•°æ®çš„æ¢ç´¢ã€å¯è§†åŒ–å’Œåˆ†æã€‚

### æ ¸å¿ƒç‰¹æ€§

- **æ•°æ®æ¢ç´¢**ï¼šå¼ºå¤§çš„æ•°æ®æœç´¢å’Œè¿‡æ»¤
- **æ•°æ®å¯è§†åŒ–**ï¼šä¸°å¯Œçš„å›¾è¡¨ç±»å‹
- **ä»ªè¡¨æ¿**ï¼šåˆ›å»ºäº¤äº’å¼ä»ªè¡¨æ¿
- **å®æ—¶åˆ†æ**ï¼šå®æ—¶æ•°æ®åˆ†æå’Œç›‘æ§
- **æ˜“äºä½¿ç”¨**ï¼šç›´è§‚çš„ç”¨æˆ·ç•Œé¢

### åº”ç”¨åœºæ™¯

- **æ—¥å¿—åˆ†æ**ï¼šELK æ ˆçš„å¯è§†åŒ–ç»„ä»¶
- **ç›‘æ§ä»ªè¡¨æ¿**ï¼šç³»ç»Ÿå’Œåº”ç”¨ç›‘æ§
- **æ•°æ®åˆ†æ**ï¼šä¸šåŠ¡æ•°æ®åˆ†æ
- **å®‰å…¨åˆ†æ**ï¼šå®‰å…¨äº‹ä»¶åˆ†æ

### å®‰è£…å’Œå¯åŠ¨

```bash
# ä¸‹è½½ Kibana
wget https://artifacts.elastic.co/downloads/kibana/kibana-8.11.0-linux-x86_64.tar.gz
tar -xzf kibana-8.11.0-linux-x86_64.tar.gz
cd kibana-8.11.0

# é…ç½® Elasticsearch è¿æ¥
# ç¼–è¾‘ config/kibana.yml
# elasticsearch.hosts: ["http://localhost:9200"]

# å¯åŠ¨ Kibana
./bin/kibana

# è®¿é—® Kibana
# http://localhost:5601
```

---

## æ ¸å¿ƒåŠŸèƒ½

### Index Patternï¼ˆç´¢å¼•æ¨¡å¼ï¼‰

å®šä¹‰è¦æœç´¢çš„ Elasticsearch ç´¢å¼•ã€‚

```bash
# åˆ›å»ºç´¢å¼•æ¨¡å¼
# Management > Index Patterns > Create index pattern
# ä¾‹å¦‚: logstash-*
```

### Discoverï¼ˆå‘ç°ï¼‰

æœç´¢å’Œæ¢ç´¢æ•°æ®ã€‚

### Visualizeï¼ˆå¯è§†åŒ–ï¼‰

åˆ›å»ºå„ç§å›¾è¡¨å’Œå¯è§†åŒ–ã€‚

### Dashboardï¼ˆä»ªè¡¨æ¿ï¼‰

ç»„åˆå¤šä¸ªå¯è§†åŒ–åˆ›å»ºä»ªè¡¨æ¿ã€‚

### Dev Toolsï¼ˆå¼€å‘å·¥å…·ï¼‰

æ‰§è¡Œ Elasticsearch æŸ¥è¯¢å’Œç®¡ç†æ“ä½œã€‚

---

## Discoverï¼ˆå‘ç°ï¼‰

### åŸºæœ¬ä½¿ç”¨

1. **é€‰æ‹©ç´¢å¼•æ¨¡å¼**ï¼šä»ä¸‹æ‹‰èœå•é€‰æ‹©
2. **æ—¶é—´èŒƒå›´**ï¼šè®¾ç½®æ—¶é—´è¿‡æ»¤å™¨
3. **æœç´¢æŸ¥è¯¢**ï¼šä½¿ç”¨ KQL æˆ– Lucene æŸ¥è¯¢
4. **æŸ¥çœ‹æ–‡æ¡£**ï¼šç‚¹å‡»æ–‡æ¡£æŸ¥çœ‹è¯¦æƒ…

### å­—æ®µæ“ä½œ

- **æ·»åŠ å­—æ®µ**ï¼šç‚¹å‡»å­—æ®µæ·»åŠ åˆ°è¡¨æ ¼
- **æ’åº**ï¼šç‚¹å‡»åˆ—æ ‡é¢˜æ’åº
- **è¿‡æ»¤**ï¼šç‚¹å‡»å­—æ®µå€¼å¿«é€Ÿè¿‡æ»¤

### å¯¼å‡ºæ•°æ®

- **CSV å¯¼å‡º**ï¼šå¯¼å‡ºæœç´¢ç»“æœ
- **å…±äº«é“¾æ¥**ï¼šç”Ÿæˆå¯åˆ†äº«çš„é“¾æ¥

---

## Visualizeï¼ˆå¯è§†åŒ–ï¼‰

### åˆ›å»ºå¯è§†åŒ–

1. **é€‰æ‹©å¯è§†åŒ–ç±»å‹**
2. **é€‰æ‹©æ•°æ®æº**
3. **é…ç½®æŒ‡æ ‡å’Œæ¡¶**
4. **ä¿å­˜å¯è§†åŒ–**

### å¯è§†åŒ–ç±»å‹

#### 1. æŸ±çŠ¶å›¾ï¼ˆVertical Barï¼‰

```json
{
  "metrics": [
    {
      "type": "count"
    }
  ],
  "buckets": [
    {
      "type": "date_histogram",
      "field": "@timestamp",
      "interval": "1h"
    }
  ]
}
```

#### 2. æŠ˜çº¿å›¾ï¼ˆLineï¼‰

```json
{
  "metrics": [
    {
      "type": "avg",
      "field": "price"
    }
  ],
  "buckets": [
    {
      "type": "date_histogram",
      "field": "@timestamp",
      "interval": "1d"
    }
  ]
}
```

#### 3. é¥¼å›¾ï¼ˆPieï¼‰

```json
{
  "metrics": [
    {
      "type": "count"
    }
  ],
  "buckets": [
    {
      "type": "terms",
      "field": "status.keyword",
      "size": 10
    }
  ]
}
```

#### 4. æ•°æ®è¡¨ï¼ˆData Tableï¼‰

```json
{
  "metrics": [
    {
      "type": "count"
    }
  ],
  "buckets": [
    {
      "type": "terms",
      "field": "user.keyword",
      "size": 10,
      "order": {
        "metric": "count",
        "direction": "desc"
      }
    }
  ]
}
```

#### 5. æŒ‡æ ‡ï¼ˆMetricï¼‰

```json
{
  "metrics": [
    {
      "type": "avg",
      "field": "price"
    },
    {
      "type": "max",
      "field": "price"
    },
    {
      "type": "min",
      "field": "price"
    }
  ]
}
```

---

## Dashboardï¼ˆä»ªè¡¨æ¿ï¼‰

### åˆ›å»ºä»ªè¡¨æ¿

1. **æ·»åŠ å¯è§†åŒ–**ï¼šä»ä¿å­˜çš„å¯è§†åŒ–ä¸­é€‰æ‹©
2. **å¸ƒå±€è°ƒæ•´**ï¼šæ‹–æ‹½è°ƒæ•´ä½ç½®å’Œå¤§å°
3. **æ—¶é—´åŒæ­¥**ï¼šè®¾ç½®å…¨å±€æ—¶é—´è¿‡æ»¤å™¨
4. **ä¿å­˜ä»ªè¡¨æ¿**ï¼šä¿å­˜é…ç½®

### ä»ªè¡¨æ¿åŠŸèƒ½

- **æ—¶é—´èŒƒå›´**ï¼šå…¨å±€æ—¶é—´è¿‡æ»¤å™¨
- **åˆ·æ–°**ï¼šè‡ªåŠ¨æˆ–æ‰‹åŠ¨åˆ·æ–°
- **å…¨å±æ¨¡å¼**ï¼šå…¨å±å±•ç¤º
- **å…±äº«**ï¼šç”Ÿæˆåˆ†äº«é“¾æ¥æˆ–åµŒå…¥ä»£ç 

---

## Dev Toolsï¼ˆå¼€å‘å·¥å…·ï¼‰

### Console

æ‰§è¡Œ Elasticsearch æŸ¥è¯¢å’Œç®¡ç†æ“ä½œã€‚

```bash
# æŸ¥çœ‹ç´¢å¼•
GET /_cat/indices?v

# æœç´¢æ–‡æ¡£
GET /my_index/_search
{
  "query": {
    "match_all": {}
  }
}

# åˆ›å»ºç´¢å¼•
PUT /my_index
{
  "settings": {
    "number_of_shards": 1
  },
  "mappings": {
    "properties": {
      "title": {
        "type": "text"
      }
    }
  }
}

# ç´¢å¼•æ–‡æ¡£
POST /my_index/_doc
{
  "title": "Test Document"
}

# æŸ¥çœ‹æ˜ å°„
GET /my_index/_mapping
```

---

## KQL æŸ¥è¯¢è¯­è¨€

### åŸºæœ¬è¯­æ³•

```kql
# å­—æ®µåŒ¹é…
status: 200

# èŒƒå›´æŸ¥è¯¢
price: > 100
price: < 200
price: >= 100 AND price: <= 200

# æ–‡æœ¬æœç´¢
message: "error"

# é€šé…ç¬¦
host: "web-*"

# é€»è¾‘æ“ä½œ
status: 200 AND method: "GET"
status: 200 OR status: 404
NOT status: 200

# å­—æ®µå­˜åœ¨
_exists_: "user"

# çŸ­è¯­åŒ¹é…
message: "quick brown fox"
```

### ç¤ºä¾‹æŸ¥è¯¢

```kql
# æŸ¥æ‰¾é”™è¯¯æ—¥å¿—
level: "error" AND timestamp: >= "2024-01-01"

# æŸ¥æ‰¾ç‰¹å®š IP
clientip: "192.168.1.100"

# æŸ¥æ‰¾ç‰¹å®šç”¨æˆ·
user: "admin" AND action: "login"

# ç»„åˆæŸ¥è¯¢
(status: 200 OR status: 404) AND method: "GET" AND response_time: > 1000
```

---

## æœ€ä½³å®è·µ

### ç´¢å¼•æ¨¡å¼

- **ä½¿ç”¨é€šé…ç¬¦**ï¼š`logstash-*` åŒ¹é…å¤šä¸ªç´¢å¼•
- **æ—¶é—´åç¼€**ï¼šä½¿ç”¨æ—¥æœŸæ ¼å¼çš„ç´¢å¼•å
- **å®šæœŸæ›´æ–°**ï¼šå®šæœŸåˆ·æ–°ç´¢å¼•æ¨¡å¼

### å¯è§†åŒ–è®¾è®¡

- **åˆç†é€‰æ‹©å›¾è¡¨ç±»å‹**ï¼šæ ¹æ®æ•°æ®ç‰¹ç‚¹é€‰æ‹©
- **é¢œè‰²æ­é…**ï¼šä½¿ç”¨æ¸…æ™°çš„é¢œè‰²æ–¹æ¡ˆ
- **æ ‡ç­¾æ¸…æ™°**ï¼šä½¿ç”¨æœ‰æ„ä¹‰çš„æ ‡ç­¾

### ä»ªè¡¨æ¿è®¾è®¡

- **é€»è¾‘åˆ†ç»„**ï¼šç›¸å…³å¯è§†åŒ–æ”¾åœ¨ä¸€èµ·
- **é‡è¦ä¿¡æ¯çªå‡º**ï¼šå…³é”®æŒ‡æ ‡æ”¾åœ¨æ˜¾çœ¼ä½ç½®
- **å“åº”å¼å¸ƒå±€**ï¼šè€ƒè™‘ä¸åŒå±å¹•å°ºå¯¸

### æ€§èƒ½ä¼˜åŒ–

- **é™åˆ¶æ•°æ®é‡**ï¼šåˆç†è®¾ç½®æ—¶é—´èŒƒå›´
- **ä½¿ç”¨è¿‡æ»¤å™¨**ï¼šå‡å°‘ä¸å¿…è¦çš„æ•°æ®
- **ç¼“å­˜æŸ¥è¯¢**ï¼šåˆ©ç”¨æŸ¥è¯¢ç¼“å­˜

---

##  å­¦ä¹ èµ„æº

- [Kibana å®˜æ–¹æ–‡æ¡£](https://www.elastic.co/guide/en/kibana/current/index.html)
- [Kibana æŸ¥è¯¢è¯­è¨€](https://www.elastic.co/guide/en/kibana/current/kuery-query.html)
- [Kibana å¯è§†åŒ–æŒ‡å—](https://www.elastic.co/guide/en/kibana/current/visualize.html)

---

## ğŸ’¡ å¸¸ç”¨æ“ä½œé€ŸæŸ¥

### åˆ›å»ºç´¢å¼•æ¨¡å¼

1. Management > Index Patterns
2. Create index pattern
3. è¾“å…¥ç´¢å¼•æ¨¡å¼ï¼ˆå¦‚ï¼š`logstash-*`ï¼‰
4. é€‰æ‹©æ—¶é—´å­—æ®µ
5. Create index pattern

### åˆ›å»ºå¯è§†åŒ–

1. Visualize > Create visualization
2. é€‰æ‹©å¯è§†åŒ–ç±»å‹
3. é€‰æ‹©æ•°æ®æº
4. é…ç½®æŒ‡æ ‡å’Œæ¡¶
5. ä¿å­˜

### åˆ›å»ºä»ªè¡¨æ¿

1. Dashboard > Create dashboard
2. Add visualization
3. é€‰æ‹©å¯è§†åŒ–
4. è°ƒæ•´å¸ƒå±€
5. ä¿å­˜

